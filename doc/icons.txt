Icon size and depth
-------------------

- NT4 only uses the colour bitmap, not the mono 'mask' bitmap for > 256 color icons
  -> transparency is wrong
- Strangely NT4 chooses highest bpp in programs but uses 4bpp or 8bpp in explorer,
  -> mixed bpp icons are shown correctly in explorer but not in programs
  (see task-bar icon, view icon or about icon)
- All other OSs starting from Win95 are handling transparency correctly
- Starting from XP 48x48 icons are used and often downscaled to lower res
  -> always provide 16x16 or 32x32 icons in 24bpp otherwise the 48x48-24bpp is downscaled


Recreate the Icon-Cache file by deleting it
-------------------------------------------

- Delete the hidden file ShellIconCache (Win9x/NT4/2k):
  C:\Windows\ShellIconCache or C:\Winnt\ShellIconCache

- Note in WinXP each user has their own file that is called Iconcache.db:
  "%USERPROFILE%\Local Settings\Application Data\Iconcache.db"

- Note in Vista or higher each user has their own file that is called Iconcache.db:
  "%LOCALAPPDATA%\Iconcache.db"

Close down all explorer.exe processes using the Task Manager (Or else it will create a faulty file during logoff/restart)
Use the Task Manager (CTRL+SHIFT+ESC) to launch the explorer.exe again (Or press CTRL+ALT+DEL to perform a restart/logoff)
When the Windows Explorer (explorer.exe) starts again, it will recreate a correct Icon-Cache file.

Vista or higher .bat file (run elevated):

taskkill /F /IM explorer.exe
cd /D "%LOCALAPPDATA%"
attrib -H IconCache.db
del IconCache.db
start explorer