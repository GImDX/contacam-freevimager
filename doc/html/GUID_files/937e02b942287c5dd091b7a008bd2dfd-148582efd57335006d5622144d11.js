function Core_Search_Register(context){var textBox=$("#"+context.parameter.textBoxId,context.wrapperElement);textBox.attr("autocomplete","off"),context.parameter.lastKeyCode=null,context.parameter.timeout=null,context.parameter.hasFocus=!1,context.parameter.lastContent="",context.parameter.searchOptionsOpen=!1,textBox.keydown(function(e){var selectedA,previousNode,popup,selectNext,done;return e.keyCode==13?(e.returnValue=!1,e.cancel=!0,context.parameter.timeout&&clearTimeout(context.parameter.timeout),popup=eval(context.parameter.popupId),popup.GetPanelNodes().length>0&&(selectedA=$("a.selected",popup.GetPanelNodes()[0].parentNode),selectedA.length>0))?(window.location=selectedA.first().attr("href"),Core_Search_HideSearchList(context),textBox.get(0).blur(),!1):(Core_Search_HideSearchList(context),textBox.get(0).blur(),Core_Search_RedirectToSearch(context),!1):e.keyCode==38?(e.returnValue=!1,e.cancel=!0,popup=eval(context.parameter.popupId),popup.GetPanelNodes().length>0&&(previousNode=null,$("a",popup.GetPanelNodes()[0].parentNode).each(function(){if($(this).hasClass("selected"))return $(this).removeClass("selected"),previousNode&&$(previousNode).addClass("selected"),!1;previousNode=this})),!1):e.keyCode==40?(e.returnValue=!1,e.cancel=!0,popup=eval(context.parameter.popupId),popup.GetPanelNodes().length>0&&(selectNext=!1,done=!1,$("a",popup.GetPanelNodes()[0].parentNode).each(function(){if($(this).hasClass("selected"))selectNext=!0,$(this).removeClass("selected");else if(selectNext)return $(this).addClass("selected"),done=!0,!1}),done||(selectNext?$("a",popup.GetPanelNodes()[0].parentNode).last().addClass("selected"):$("a",popup.GetPanelNodes()[0].parentNode).first().addClass("selected"))),!1):void 0}).focus(function(){context.parameter.hasFocus=!0,$(this).hasClass("empty")||(context.parameter.lastKeyCode=-1,context.parameter.timeout&&clearTimeout(context.parameter.timeout),Core_Search_OnChange(context)),context.parameter.checkForChangeHandler=window.setTimeout(function(){Core_Search_CheckForChange(context)},99)}).blur(function(){context.parameter.hasFocus=!1,context.parameter.timeout&&clearTimeout(context.parameter.timeout),context.parameter.checkForChangeHandler&&clearTimeout(context.parameter.checkForChangeHandler)}),$(".internal-link.search-options",context.wrapperElement).click(function(){return context.parameter.searchOptionsOpen==!1&&(context.parameter.searchOptionsOpen=!0,Core_Search_HideSearchList(context),eval(context.parameter.searchOptionsPopup).ShowAtElement(this),$(this).addClass("active active__internal-link active__internal-link__search-options active__search-options")),!1}),$("input[name="+context.parameter.searchOptionName+"]").click(function(){context.parameter.searchOptionsOpen=!1,eval(Core_Search_CurrentSearch.parameter.searchOptionsPopup).Hide(),$(".internal-link.search-options",context.wrapperElement).removeClass("active active__internal-link active__internal-link__search-options active__search-options"),Core_Search_CurrentSearch=null,Core_Search_FilterChanged(context)})}function Core_Search_CheckForChange(n){n.parameter.checkForChangeHandler&&clearTimeout(n.parameter.checkForChangeHandler);var t=$("#"+n.parameter.textBoxId,n.wrapperElement);t.val()!=n.parameter.lastValue&&(n.parameter.lastValue=t.val(),n.parameter.lastKeyCode=-1,n.parameter.timeout&&clearTimeout(n.parameter.timeout),n.parameter.timeout=setTimeout(function(){Core_Search_OnChange(n)},500),n.parameter.lastValue.length>0?Core_Search_ShowSearchList(n,n.parameter.searchSearchingHtmlBlock):Core_Search_HideSearchList(n)),n.parameter.hasFocus&&(n.parameter.checkForChangeHandler=window.setTimeout(function(){Core_Search_CheckForChange(n)},99))}function Core_Search_FilterChanged(n){$("#"+n.parameter.textBoxId,n.wrapperElement).focus()}function Core_Search_RedirectToSearch(n){var f=$("#"+n.parameter.textBoxId,n.wrapperElement),u=f.val(),i,t,r;u.length<=0||(i=$("input[name="+n.parameter.searchOptionName+"]:checked"),t="",i.length>0&&(t=i.attr("value").split(":")),t.length!=2&&(t=["",0]),r='{"queryText":"'+u.replace(/\"/g,'\\"')+'","filterType":"'+t[0]+'","filterId":'+t[1]+"}",$.ajax({type:"POST",url:Core_Search_AjaxEndpoint+"/GetSearchRedirect",data:r,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(n){TelligentUtility.WriteAuthorizationHeader(n)},success:function(n){window.location=n.d.SearchLink}}))}function Core_Search_OnChange(n){var r,i,u,t,f;n.parameter.lastKeyCode>8&&n.parameter.lastKeyCode<46||(r=$("#"+n.parameter.textBoxId,n.wrapperElement),i=r.val(),i.length>0?r.removeClass("empty"):r.addClass("empty"),i.length>0?(u=$("input[name="+n.parameter.searchOptionName+"]:checked"),t="",u.length>0&&(t=u.attr("value").split(":")),t.length!=2&&(t=["",0]),f='{"queryText":"'+i.replace(/\"/g,'\\"')+'","filterType":"'+t[0]+'","filterId":'+t[1]+"}",$.ajax({type:"POST",url:Core_Search_AjaxEndpoint+"/Search",data:f,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(n){TelligentUtility.WriteAuthorizationHeader(n)},success:function(t){if(n.parameter.hasFocus!=!1){var i=t.d;i.length>0?(content=n.parameter.showAllHtmlBlock.replace(/{ShowAllLink}/g,i[0].SearchLink),$.each(i,function(){var t=n.parameter.searchGroupHtmlBlock.replace(/{ContentName}/g,this.ContentName),i="";$.each(this.Documents,function(){var t=n.parameter.searchItemHtmlBlock.replace(/{Link}/g,this.Link);t=t.replace(/{Title}/g,this.Title),t=t.replace(/{LinkType}/g,this.LinkType),i+=t}),t=t.replace(/{ContentItems}/g,i),content+=t}),content=n.parameter.searchResultWrapperHtmlBlock.replace(/{SearchResults}/g,content)):content=n.parameter.searchNoResultsHtmlBlock,Core_Search_ShowSearchList(n,content)}},error:function(){if(n.parameter.hasFocus!=!1){content=n.parameter.searchErrorHtmlBlock;var u=setTimeout(function(){Core_Search_ShowSearchList(n,content)},100)}}})):Core_Search_HideSearchList(n))}function Core_Search_ShowSearchList(context,content){var popup,e;context.parameter.lastKeyCode!=13&&(popup=eval(context.parameter.popupId),context.parameter.lastContent!=content&&(context.parameter.lastContent=content,popup.SetPanelContent(content),popup.Refresh()),popup.IsShown()||(e=$("#"+context.parameter.textBoxId,context.wrapperElement).get(0),popup.ShowAtElement(e)))}function Core_Search_HideSearchList(context){var popup=eval(context.parameter.popupId);popup.Hide()}function Core_Search_MouseOverSearchOptions(n){n.parameter.mouseInPopup=!0}function Core_Search_MouseOutSearchOptions(n){n.parameter.mouseInPopup=!1}function Core_Search_DocumentClick(){Core_Search_CurrentSearch&&!Core_Search_CurrentSearch.parameter.mouseInPopup&&(Core_Search_CurrentSearch.parameter.searchOptionsOpen=!1,eval(Core_Search_CurrentSearch.parameter.searchOptionsPopup).Hide(),$(".internal-link.search-options",Core_Search_CurrentSearch.wrapperElement).removeClass("active active__internal-link active__internal-link__search-options active__search-options"),Core_Search_CurrentSearch=null)}function Core_Search_SearchOptionsOpened(n){Core_Search_CurrentSearch=n}var Core_Search_CurrentSearch=null;$(function(){$(document).bind("click",Core_Search_DocumentClick)})